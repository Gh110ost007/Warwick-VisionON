{% extends "base.html" %}
{% block title %}My Artworks{% endblock %}
{% block head %}
  <!-- If needed, include your login-specific CSS here -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/table.css') }}">
{% endblock %}
{% block content %}

  <div class="my-5">
    <div class="p-5 text-center bg-body-tertiary">
      <div class="container py-5">
        <h1 class="text-body-emphasis wow">My Artwork</h1>
      </div>
    </div>
  </div>
  
  {% if artworks|length == 0 %}
  <div class="full-page">
    <p class="hold">You have no uploaded any artworks yet.</p>
  </div>
  {% else %}
    <table class="invoice-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>File</th>
          <th>Status</th>
          <th>Location</th>
          <th>Identifier</th>
          <th>QR Code</th>
          <th>Archived Info</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for art in artworks %}
        <tr>
          <td><a href="#">{{ art.id }}</a></td>
          <td>{{ art.name }}</td>
          <td>{{ art.image_file }}</td>
          <td>
            {% if art.moderation_status == 'pending' %}
              <p class="status status-pending">Pending</p>
            {% elif art.moderation_status == 'moderated' %}
              <p class="status status-paid">Moderated</p>
            {% elif art.moderation_status == 'unmoderated' %}
              <p class="status status-unpaid">Unmoderated</p>
            {% else %}
              <p class="status">{{ art.moderation_status }}</p>
            {% endif %}
          </td>
          <td>{{ art.location }}</td>
          <td>{{ art.identifier if art.identifier else "N/A" }}</td>
          <td>
            {% if art.qr_code %}
              <img src="{{ url_for('static', filename='qr_codes/' ~ art.qr_code) }}" alt="QR Code" style="max-width:100px;">
            {% else %}
              N/A
            {% endif %}
          </td>
          <td>
            {% if art.archived %}
              Archived by {{ art.archived_by if art.archived_by else "unknown" }} on 
              {% if art.archived_date %}{{ art.archived_date.strftime('%Y-%m-%d %H:%M') }}{% else %}unknown date{% endif %}
            {% else %}
              Not archived
            {% endif %}
          </td>
          <td>
            {% if art.archived %}
              <form action="{{ url_for('unarchive_artwork', artwork_id=art.id) }}" method="post" style="display:inline;">
                <button type="submit" class="bbutton" style="margin-bottom: 0.5rem;">Unarchive</button>
              </form>
            {% else %}
              <form action="{{ url_for('archive_artwork', artwork_id=art.id) }}" method="post" style="display:inline;">
                <button type="submit" class="bbutton">Archive</button>
              </form>
            {% endif %}
            {% if art.moderation_status == 'unmoderated' %}
              <form action="{{ url_for('request_moderation', artwork_id=art.id) }}" method="post" style="display:inline;">
                <button type="submit"class="bbutton">Request Moderation</button>
              </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

{% endblock %}
